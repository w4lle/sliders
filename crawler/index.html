<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>客户端爬取</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="../templates/revealjs/css/reveal.css">
		<link rel="stylesheet" href="../templates/revealjs/css/theme/black.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../templates/revealjs/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../templates/revealjs/css/print/pdf.css' : '../templates/revealjs/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
			<div class="slides"><section  data-markdown><script type="text/template"># 客户端爬取

王令龙 

2018.12.20
</script></section><section  data-markdown><script type="text/template">
## 目录

- 基本概念
- 客户端爬取的姿势
- 演进历史
- 接下来要做什么
- Q&A
</script></section><section ><section data-markdown><script type="text/template">
## 基本概念

- 数据爬取&解析
- 账单类型分类
- 风控等级分类
- 登录类型分类
</script></section><section data-markdown><script type="text/template">
### 数据爬取&解析

![](https://ws2.sinaimg.cn/large/006tNbRwly1fyd9libfcjj30lz065aaf.jpg)
</script></section><section data-markdown><script type="text/template">
#### 爬取类型

- http 请求爬取
- Headless 浏览器爬取
</script></section><section data-markdown><script type="text/template">
### 账单类型分类

TaskType

- MAIL 邮箱
- BANK 网银
- ECOMMERCE 电商
- GJJ 公积金
- OTHER 其他
</script></section><section data-markdown><script type="text/template">
#### MAIL 邮箱

TaskSubType

- qq.com
- 163.com
- 126.com
- sina.com
- hotmail.com
- 139.com (服务端登录)
</script></section><section data-markdown><script type="text/template">
#### BANK 网银

TaskSubType

- 招商
- 浦发
- 交通
- ...
</script></section><section data-markdown><script type="text/template">
#### ECOMMERCE 电商

TaskSubType

- JD
- TAOBAO
- ALIPAY
- TENCENT
- MEITUAN
- ...
</script></section><section data-markdown><script type="text/template">
### 风控等级分类
</script></section><section data-markdown><script type="text/template">
#### 高风控等级

- 电商
- 邮箱
</script></section><section data-markdown><script type="text/template">
#### 低风控等级

- 大部分网银
- 其他
</script></section><section data-markdown><script type="text/template">
### 登录类型分类

为什么需要客户端登录？

- 服务端登录 
- 客户端登录
- 无需登录
</script></section><section data-markdown><script type="text/template">
#### 服务端登录

提交用户名密码给服务端，服务端后台登录爬取

- 139 邮箱&其他邮箱
- 网银
- 公积金
- 水电煤
- 其他低风控等级类型
</script></section><section data-markdown><script type="text/template">
#### 几种方式：

- webview 中填写用户名密码 - 网银
- 原声界面填写用户名密码 - 其他邮箱
- 静默更新
- 自动更新
</script></section><section data-markdown><script type="text/template">
#### 客户端登录

客户端登录获取 cookie，服务端拿到 cookie 后爬取

- 邮箱
- 电商
- 其他高风控等级类型
</script></section><section data-markdown><script type="text/template">
#### 无需登录

- 短信账单
- 手输账单
- ...
</script></section></section><section ><section data-markdown><script type="text/template">
## 客户端爬取的姿势

![](https://ws2.sinaimg.cn/large/006tNbRwly1fyc6n3xrgbj30l50er0u2.jpg)
</script></section><section data-markdown><script type="text/template">
### 

<img src="https://ws3.sinaimg.cn/large/006tNbRwly1fydba7vdq7j30i20l6q50.jpg" width = "550" height = "650" alt="图片名称" align=center />
</script></section></section><section ><section data-markdown><script type="text/template">
## 演进历史

- BankCrawling 网银静默，自带轮询器 
- H5Crawling 对应 PG：openECommerceCrawling，根据配置支持电商、邮箱等获取 cookie 及帐密
- MailCrawling 一期，抽取管家邮箱导入逻辑，基于 H5Crawling，给人品使用
- CrawlerServer 统一与服务端交互的逻辑，包括创建、轮询、拉取配置等等
- MailCrawling 二期，依赖 CrawlerServer，接入管家，管家老代码废弃
- TaskEngine 一期，基于双webview实现抓取引擎，接入管家实现京东、邮箱静默
</script></section><section data-markdown><script type="text/template">
### 

- TaskEngine 二期，实现纯客户端爬取，服务端不需要爬取，只负责解析
- MailCrawling 三期，依赖 TaskEngine 实现静默抓取，支持动态降级单webview方案
- LongConnection 长连接代理
</script></section></section><section  data-markdown><script type="text/template">
## 接下来要做什么

- 统一爬取监控
- 优化 TaskEngine，提高防风控能力
- 基于 TaskEngine 新建通用电商壳，逐渐替换 H5Crawling
- LongConnection 线上逐步推广使用
</script></section><section  data-markdown><script type="text/template">
## Q&A
</script></section></div>
		</div>

		<script src="../templates/revealjs/lib/js/head.min.js"></script>
		<script src="../templates/revealjs/js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: '../templates/revealjs/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../templates/revealjs/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../templates/revealjs/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../templates/revealjs/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../templates/revealjs/plugin/zoom-js/zoom.js', async: true },
					{ src: '../templates/revealjs/plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
